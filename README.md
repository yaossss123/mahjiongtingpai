# 麻将听牌判断程序

一个用Python实现的麻将听牌分析工具，可以输入13张牌并计算出所有可能的胡牌。

## 功能特点

- ✅ 支持标准麻将规则（4面子+1对子）
- ✅ 支持七对子胡牌
- ✅ 支持所有花色：条子、万子、筒子、字牌
- ✅ 智能听牌分析，显示所有可胡的牌
- ✅ 详细的手牌统计信息
- ✅ 中文显示牌名
- ✅ 输入验证和错误处理

## 牌型表示法

| 花色 | 表示法 | 说明 |
|------|--------|------|
| 条子(索子) | 1-9s | 1s=一条, 2s=二条, ..., 9s=九条 |
| 万子 | 1-9m | 1m=一万, 2m=二万, ..., 9m=九万 |
| 筒子(饼子) | 1-9p | 1p=一筒, 2p=二筒, ..., 9p=九筒 |
| 字牌 | 1-7z | 1z=东, 2z=南, 3z=西, 4z=北, 5z=白, 6z=发, 7z=中 |

## 使用方法

### 基本使用

```bash
# 运行主程序
python mahjong_tingpai.py

# 运行测试程序
python test_mahjong.py
```

### 输入格式

输入13张牌，使用上述表示法：

```
# 示例1：万子顺子 + 筒子听牌
123456789m112p34p

# 示例2：七对子听牌
1122334455667m8m

# 示例3：字牌混合
123m456p789s111z2z
```

## 程序结构

### 主要文件

- `mahjong_tingpai.py` - 主程序，包含核心算法
- `test_mahjong.py` - 测试程序，包含测试用例和演示
- `README.md` - 说明文档

### 核心类：MahjongTingpai

#### 主要方法

- `parse_hand(hand_str)` - 解析手牌字符串
- `is_winning_hand(tiles)` - 判断14张牌是否胡牌
- `find_winning_tiles(hand)` - 找出所有可胡的牌
- `analyze_hand(hand_str)` - 完整分析手牌
- `print_analysis(result)` - 打印分析结果

## 算法说明

### 胡牌判断算法

1. **标准胡牌**：4个面子 + 1个对子
   - 面子：顺子（连续3张同花色）或刻子（3张相同牌）
   - 对子：2张相同牌

2. **七对子**：7个不同的对子

3. **递归组合算法**：
   - 尝试所有可能的面子组合
   - 使用回溯法找到有效组合
   - 优化剪枝提高效率

### 听牌分析

对每张可能的牌（共34种）：
1. 将其加入手牌形成14张牌
2. 判断是否构成胡牌
3. 收集所有可胡的牌

## 使用示例

### 示例1：基本听牌

```
输入：123456789m112p34p
结果：听2筒、5筒（两面听）
```

### 示例2：七对子

```
输入：1122334455667m8m
结果：听8万（七对子）
```

### 示例3：字牌听牌

```
输入：123m456p789s111z2z
结果：听南风（2z）
```

## 测试用例

运行 `test_mahjong.py` 可以测试以下情况：

- ✅ 单钓听牌
- ✅ 边张听牌
- ✅ 坎张听牌
- ✅ 两面听牌
- ✅ 多面听牌
- ✅ 七对子听牌
- ✅ 字牌听牌
- ✅ 混合花色听牌
- ✅ 错误输入处理

## 程序特色

### 1. 智能输入解析
- 支持连续数字输入：`123456789s` = `1s2s3s4s5s6s7s8s9s`
- 自动排序和格式化
- 输入验证和错误提示

### 2. 详细分析报告
- 手牌统计信息
- 花色分布
- 牌频统计
- 听牌结果（中英文对照）

### 3. 多种使用模式
- 交互式输入
- 批量测试
- 示例演示

## 技术实现

### 依赖库
- Python 3.6+
- 标准库：`re`, `collections`, `typing`

### 算法复杂度
- 时间复杂度：O(1) - 固定34种牌的检测
- 空间复杂度：O(1) - 固定大小的数据结构

### 代码特点
- 面向对象设计
- 类型提示支持
- 完整的错误处理
- 详细的注释文档

## 扩展功能

### 可能的改进方向

1. **更多胡牌类型**
   - 国士无双
   - 九莲宝灯
   - 清一色等特殊牌型

2. **番数计算**
   - 根据牌型计算番数
   - 支持不同地区规则

3. **AI建议**
   - 打牌建议
   - 听牌概率分析

4. **图形界面**
   - GUI界面
   - 牌面可视化

## 常见问题

### Q: 为什么我的输入显示"未听牌"？
A: 请检查：
- 是否正好13张牌
- 牌型表示是否正确
- 是否有重复超过4张的牌

### Q: 支持哪些特殊牌型？
A: 目前支持：
- 标准胡牌（4面子+1对子）
- 七对子
- 暂不支持国士无双等特殊牌型

### Q: 字牌怎么输入？
A: 字牌用1-7z表示：
- 1z=东, 2z=南, 3z=西, 4z=北
- 5z=白, 6z=发, 7z=中

## 开发信息

- 开发语言：Python 3
- 开发时间：2025年1月
- 版本：1.0
- 许可证：MIT

---

**享受麻将的乐趣！** 🀄